(window.webpackJsonp=window.webpackJsonp||[]).push([[29,7,14,17],{602:function(t,e,r){"use strict";r.r(e);var o=r(238),n=r(31),component=Object(n.a)({},(function(){var t=this._self._c;return t("div",{staticClass:"text-center"},[t(o.a,{attrs:{indeterminate:""}})],1)}),[],!1,null,null,null);e.default=component.exports},604:function(t,e,r){"use strict";r.r(e);var o=r(592),n={props:{color:{type:String,default:null},message:{type:String,default:null}}},l=r(31),component=Object(l.a)(n,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-center",on:{click:function(e){return t.$emit("click")}}},[e(o.a,{attrs:{color:t.color}},[t._v(t._s(t.message))])],1)}),[],!1,null,null,null);e.default=component.exports},668:function(t,e,r){"use strict";r.r(e);var o=r(572),n=r(685),l=r(598),c=r(597),d=r(590),v=r(243),m=r(155),_=r(244),f=r(165),h=r(591),y=(r(8),r(7),r(13),r(14),r(1)),P=r(22),j=(r(63),r(4),r(76),r(10),r(11),r(166),r(108));function O(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function x(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?O(Object(source),!0).forEach((function(e){Object(y.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):O(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var k={components:{ValidationObserver:j.a,ValidationProvider:j.b},data:function(){return{loading:!1,demands:[],form:{title:this.$moment().locale("pt-br").format("MMM-YYYY").toUpperCase(),status:"pending",points:0,price:0,estimate_in_days:0,items:[]}}},computed:{customer:function(){return this.$store.state.customer},totalPrice:function(){return this.selectedItems.reduce((function(t,e){return t+e.price}),0)},totalPoints:function(){return this.selectedItems.reduce((function(t,e){return t+e.points}),0)},totalEstimateInDays:function(){return this.selectedItems.reduce((function(t,e){return t+e.estimate_in_days}),0)},selectedItems:function(){return this.form.items.filter((function(t){return t.checked})).map((function(t){return{demand:t.demand._id,points:t.points,price:t.price,estimate_in_days:t.estimate_in_days}}))}},created:function(){this.loadDemands()},methods:{loadDemands:function(){var t=this;return Object(P.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.$axios.$get("/v1/demands",{params:{status:"backlog",customer:t.customer._id,approved:!1,billable:!0,with_points:!0}});case 3:t.demands=e.sent,t.demands.forEach((function(e){t.form.items.push({demand:e,price:e.price,points:e.points,estimate_in_days:e.estimate_in_days,checked:!1})})),t.loading=!1;case 6:case"end":return e.stop()}}),e)})))()},save:function(){var t=this,form=x({},this.form);form.items=this.selectedItems,form.price=this.totalPrice,form.points=this.totalPoints,form.estimate_in_days=this.totalEstimateInDays,this.loading=!0,this.$axios.$post("/v1/proposals",x(x({},form),{},{customer:this.customer._id})).then((function(e){t.$notifier.success("Proposta gerada!"),t.$emit("input",e)})),this.loading=!1},toggleMonth:function(t){this.active_month===t?this.active_month=null:this.active_month=t},removeItem:function(t,e,r){this.form.data[t-1][e-1].splice(r,1)},close:function(){this.$emit("close")}}},w=r(31),component=Object(w.a)(k,(function(){var t=this,e=t._self._c;return e(c.a,{attrs:{value:!0,fullscreen:"",persistent:""}},[e(o.a,{staticClass:"template-form"},[e("DialogHeader",{on:{close:t.close}}),t._v(" "),t.loading?e("div",{staticClass:"pt-6"},[e("Loading")],1):e("div",[e(l.a,[e("h3",[t._v("Gerar proposta comercial")])]),t._v(" "),e("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(r){var o=r.validate,c=r.invalid;return[e(d.a,{on:{submit:function(e){e.preventDefault(),o().then(t.save)}}},[e("div",[e(l.a,[e("validation-provider",{attrs:{name:"Título da proposta",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(r){var o=r.errors;return[e(h.a,{attrs:{rows:"1","auto-grow":"",label:"Título da proposta",outlined:"","error-messages":o,focusable:""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})]}}],null,!0)}),t._v(" "),e("div",[t._v("Selecione as demandas que deseja incluir na proposta:")])],1),t._v(" "),e(v.a,{attrs:{color:"secondary"}},t._l(t.form.items,(function(r){return e(m.a,{key:r._id},[e(f.a,[e(f.c,[t._v("\n                    "+t._s(r.demand.title)+"\n                  ")]),t._v(" "),r.points>0?e(f.b,[t._v("\n                    "+t._s(t._f("moeda")(r.price))+" ("+t._s(r.estimate_in_days)+"\n                    dias)\n                  ")]):t._e()],1),t._v(" "),e(_.a,[e(n.a,{attrs:{color:"primary"},model:{value:r.checked,callback:function(e){t.$set(r,"checked",e)},expression:"item.checked"}})],1)],1)})),1),t._v(" "),e(l.a,[e("h3",[t._v("\n                Total: "+t._s(t._f("moeda")(t.totalPrice))+" ("+t._s(t.totalEstimateInDays)+"\n                dias)\n              ")]),t._v(" "),t.totalPoints>0?e("div",{staticClass:"text-right"},[e("Save",{attrs:{invalid:c,block:!1,label:"Salvar"}})],1):t._e()])],1)])]}}])})],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{DialogHeader:r(359).default,Loading:r(602).default,Save:r(360).default})},669:function(t,e,r){"use strict";r.r(e);var o=r(242),n=r(572),l=r(609),c=r(598),d=r(597),v=r(154),m=r(693),_=(r(26),r(22)),f=(r(63),{props:{proposalId:{type:String,required:!0}},data:function(){return{dialog:!1,proposal:null,previewDemand:null}},computed:{baseUrl:function(){return"https://cultivardigital.com.br"}},created:function(){this.loadProposal()},methods:{loadProposal:function(){var t=this;return Object(_.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.proposal=null,e.next=3,t.$axios.$get("/v1/proposals/"+t.proposalId+"/info");case 3:t.proposal=e.sent;case 4:case"end":return e.stop()}}),e)})))()},approve:function(){var t=this;return Object(_.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.$patch("/v1/proposals/"+t.proposalId+"/approve");case 2:r=e.sent,t.loadProposal(),t.$emit("input",r);case 5:case"end":return e.stop()}}),e)})))()},reject:function(){var t=this;return Object(_.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.$patch("/v1/proposals/"+t.proposalId+"/reject");case 2:r=e.sent,t.loadProposal(),t.$emit("input",r);case 5:case"end":return e.stop()}}),e)})))()},cancel:function(){var t=this;return Object(_.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.$patch("/v1/proposals/"+t.proposalId+"/cancel");case 2:r=e.sent,t.loadProposal(),t.$emit("input",r);case 5:case"end":return e.stop()}}),e)})))()},close:function(){this.$emit("close")},copy:function(t){var e=this;return Object(_.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,navigator.clipboard.writeText(t);case 2:e.notify("Copiado!");case 3:case"end":return r.stop()}}),r)})))()}}}),h=r(31),component=Object(h.a)(f,(function(){var t=this,e=t._self._c;return e(d.a,{attrs:{value:!0,fullscreen:"",persistent:""}},[e(n.a,{staticClass:"template-form"},[e("DialogHeader",{on:{close:t.close}}),t._v(" "),e("div",[t.proposal?e("div",[e(c.a,[e("h2",{staticClass:"mb-6"},[t._v("Proposta comercial")]),t._v(" "),t.proposal.canceled?e("Alert",{attrs:{message:"Proposta cancelada",color:"error"}}):t._e(),t._v(" "),e("div",{staticClass:"d-flex justify-space-between align-start"},[e("div",[e("h3",[t._v("\n                "+t._s(t.proposal.title)+"\n              ")]),t._v(" "),t.proposal.startAt&&t.proposal.deadline?e("p",[e("small",[t._v("\n                  "+t._s(t.$moment(t.proposal.startAt).format("DD/MM/YYYY"))+" - "+t._s(t.$moment(t.proposal.deadline).format("DD/MM/YYYY"))+"\n                ")])]):e("p",[e("small",[t._v("\n                  "+t._s(t.$moment(t.proposal.createdAt).format("DD/MM/YYYY"))+"\n                ")])])]),t._v(" "),e("div",["approved"===t.proposal.status?e(l.a,{attrs:{outlined:"",small:"",color:"success"}},[e(v.a,{attrs:{left:"",small:""}},[t._v(" mdi-check ")]),t._v("\n                Aprovada\n              ")],1):t._e(),t._v(" "),"rejected"===t.proposal.status?e(l.a,{attrs:{outlined:"",small:"",color:"error"}},[e(v.a,{attrs:{left:"",small:""}},[t._v(" mdi-close-thick ")]),t._v("\n                Rejeitada\n              ")],1):t._e(),t._v(" "),"canceled"===t.proposal.status?e(l.a,{attrs:{outlined:"",small:"",color:"error"}},[e(v.a,{attrs:{left:"",small:""}},[t._v(" mdi-cancel ")]),t._v("\n                Cancelada\n              ")],1):t._e(),t._v(" "),"pending"===t.proposal.status?e(l.a,{attrs:{small:"",outlined:""}},[e(v.a,{attrs:{left:"",small:""}},[t._v(" mdi-clock ")]),t._v("\n                Aguardando aprovação\n              ")],1):t._e()],1)]),t._v(" "),e("div",[e("p",[t._v("\n              A proposta abaixo foi personalizada por via de um levantamento\n              de requisitos e análise prévia para a execução das demandas\n              solicitadas.\n            ")])]),t._v(" "),e(m.a,{staticClass:"mb-6",attrs:{light:""},scopedSlots:t._u([{key:"default",fn:function(){return[e("thead",[e("tr",[e("th",{staticClass:"text-left"},[t._v("Demanda")]),t._v(" "),e("th",[t._v("Estimativa")]),t._v(" "),e("th",[t._v("Valor")]),t._v(" "),e("th")])]),t._v(" "),e("tbody",t._l(t.proposal.items,(function(r){return e("tr",{key:r._id},[e("td",[e("small",[t._v(t._s(r.demand.title))])]),t._v(" "),e("td",[e("small",[t._v(t._s(t.$utils.plural(r.estimate_in_days,"dia")))])]),t._v(" "),e("td",[e("small",[t._v(t._s(t._f("moeda")(r.price)))])]),t._v(" "),e("td",[e(o.a,{attrs:{"x-small":"",icon:""},on:{click:function(e){t.previewDemand=r.demand}}},[e(v.a,[t._v("mdi-eye")])],1)],1)])})),0),t._v(" "),e("tfoot",[e("tr",[e("th",[e("strong",[t._v("Total")])]),t._v(" "),e("th",[e("strong",[t._v(t._s(t.$utils.plural(t.proposal.estimate_in_days,"dia")))])]),t._v(" "),e("th",[e("strong",[t._v(t._s(t._f("moeda")(t.proposal.price)))])]),t._v(" "),e("th")])])]},proxy:!0}],null,!1,2509273074)}),t._v(" "),e("div",{staticClass:"mb-6"},[e("h5",{staticClass:"mb-3"},[t._v("OBSERVAÇÕES:")]),t._v(" "),e("ul",{staticClass:"mb-10"},[e("li",[e("small",[t._v("\n                  Os prazos e valores acima foram estimados baseados em\n                  levantamento de requisitos e análise prévia das\n                  funcionalidades, portanto, esta proposta tem caráter de\n                  escopo fechado e qualquer mudança de escopo invalida esta\n                  proposta.\n                ")])])]),t._v(" "),"approved"===t.proposal.status&&t.proposal.approved_by?e("div",{staticClass:"text-center mb-10"},[e(v.a,{attrs:{"x-large":""}},[t._v("mdi-check")]),t._v(" "),e("br"),t._v(" "),e("small",[e("strong",[t._v("Aprovada por:")]),t._v(" "),e("br"),t._v("\n                "+t._s(t.proposal.approved_by.name)+"\n              ")])],1):t._e(),t._v(" "),"rejected"===t.proposal.status&&t.proposal.rejected_by?e("div",{staticClass:"text-center mb-10"},[e(v.a,{attrs:{"x-large":""}},[t._v("mdi-close-thick")]),t._v(" "),e("br"),t._v(" "),e("small",[e("strong",[t._v("Rejeitada por:")]),t._v(" "),e("br"),t._v("\n                "+t._s(t.proposal.rejected_by.name)+"\n              ")])],1):t._e(),t._v(" "),"canceled"===t.proposal.status&&t.proposal.canceled_by?e("div",{staticClass:"text-center mb-10"},[e(v.a,{attrs:{"x-large":""}},[t._v("mdi-cancel")]),t._v(" "),e("br"),t._v(" "),e("small",[e("strong",[t._v("Cancelada por:")]),t._v(" "),e("br"),t._v("\n                "+t._s(t.proposal.canceled_by.name)+"\n              ")])],1):t._e()]),t._v(" "),"canceled"===t.proposal.status?e("Alert",{attrs:{message:"Proposta cancelada",color:"error"}}):t._e(),t._v(" "),"rejected"===t.proposal.status?e("Alert",{attrs:{message:"Proposta rejeitada",color:"error"}}):t._e(),t._v(" "),"pending"===t.proposal.status?e("div",{staticClass:"text-center"},[e("div",{staticClass:"mb-6"},[e("ProposalApprove",{attrs:{proposal:t.proposal},on:{confirm:t.approve}})],1),t._v(" "),e(o.a,{staticClass:"mb-6",attrs:{small:""},on:{click:function(){return t.copy(t.baseUrl+"/atendimento?modulo=propostas&proposta="+t.proposal._id)}}},[e(v.a,{attrs:{left:"",small:""}},[t._v(" mdi-content-copy ")]),t._v("\n              Copiar link da proposta\n            ")],1),t._v(" "),"customer"===t.$auth.user.role?e(o.a,{staticClass:"mb-6",attrs:{small:"",color:"error"},on:{click:t.reject}},[e(v.a,{attrs:{left:""}},[t._v(" mdi-close-thick ")]),t._v("\n              Rejeitar esta proposta\n            ")],1):t._e(),t._v(" "),"provider"===t.$auth.user.role?e(o.a,{staticClass:"mb-6",attrs:{small:""},on:{click:t.cancel}},[e(v.a,{attrs:{left:""}},[t._v(" mdi-close ")]),t._v("\n              Cancelar esta proposta\n            ")],1):t._e()],1):t._e(),t._v(" "),e("div",{staticClass:"text-center pt-10 mb-10"},[e("div",[e("img",{staticClass:"logo",attrs:{src:r(366)}}),t._v(" "),e("br"),t._v(" "),e("strong",[t._v("Cultivar Digital")])]),t._v(" "),e("div",[e("small",[t._v("Diego M. Rodrigues")])])])],1)],1):e("div",{staticClass:"pt-6"},[e("Loading")],1)]),t._v(" "),t.previewDemand?e("Demand",{attrs:{demand:t.previewDemand,preview:""},on:{close:function(e){t.previewDemand=null}}}):t._e()],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{DialogHeader:r(359).default,Alert:r(604).default,ProposalApprove:r(670).default,Loading:r(602).default,Demand:r(657).default})},701:function(t,e,r){"use strict";r.r(e);var o=r(242),n=r(572),l=r(609),c=r(598),d=r(154),v=(r(8),r(7),r(10),r(4),r(13),r(11),r(14),r(1));function m(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function _(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(e){Object(v.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var f=r(22),h=(r(63),r(85),r(216),r(166),{layout:"customer",data:function(){return{proposals:null,addProposal:!1}},computed:{customer:function(){return this.$store.state.customer},activeProposal:function(){var t=this;return this.$route.query.proposta&&this.proposals?this.proposals.find((function(e){return e._id===t.$route.query.proposta})):null}},watch:{customer:function(){this.loadProposals()}},created:function(){var t=this;return Object(f.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.customer){e.next=3;break}return e.next=3,t.loadProposals();case 3:case"end":return e.stop()}}),e)})))()},methods:{loadProposals:function(){var t=this;return Object(f.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.proposals=null,e.next=3,t.$axios.$get("/v1/proposals",{params:{customer:t.customer._id}});case 3:t.proposals=e.sent;case 4:case"end":return e.stop()}}),e)})))()},estimateInDays:function(t){return Math.ceil(t/this.customer.points_per_day)},proposalCreated:function(){this.addProposal=!1,this.loadProposals(),this.loadSummary()},proposalUpdated:function(t){var e=this.proposals.findIndex((function(e){return e._id===t._id}));this.proposals.splice(e,1,t),this.loadSummary()},openProposal:function(t){this.$router.push({query:{proposta:t._id}})},closeProposal:function(){this.$router.push("/"+this.customer._id+"/propostas")},loadSummary:function(){this.$store.dispatch("loadCustomerSummary")}}}),y=r(31),component=Object(y.a)(h,(function(){var t=this,e=t._self._c;return e("div",["provider"===t.$auth.user.role?e(o.a,{attrs:{fab:"",fixed:"",bottom:"",right:"",color:"success"},on:{click:function(e){t.addProposal=!0}}},[e(d.a,[t._v("mdi-plus")])],1):t._e(),t._v(" "),e(c.a,[e("div",[t.proposals?e("div",[t.proposals.length?t._e():e("div",[e("Alert",{attrs:{message:"Nenhuma proposta aqui"}})],1),t._v(" "),t.proposals&&t.proposals.length?e("div",t._l(t.proposals,(function(r){return e(n.a,{key:r._id,staticClass:"mb-3 pa-3",on:{click:function(e){return t.openProposal(r)}}},[e("div",[e("h4",{staticClass:"mb-1"},[t._v(t._s(r.title))]),t._v(" "),r.points>0?e("div",[e("div",{staticClass:"mb-1"},[r.startAt&&r.deadline?e("div",{staticClass:"caption"},[t._v("\n                    "+t._s(t.$moment(r.startAt).format("DD/MM/YYYY"))+" -\n                    "+t._s(t.$moment(r.deadline).format("DD/MM/YYYY"))+"\n                  ")]):e("div",[e("small",[t._v("\n                      "+t._s(t.$moment(r.createdAt).format("DD/MM/YYYY"))+"\n                    ")])])]),t._v(" "),e("div",[e("EstimateValues",{attrs:{item:_(_({},r),{},{billable:!0})}})],1)]):t._e(),t._v(" "),e("div",{staticClass:"pt-3"},[e("div",["approved"===r.status?e(l.a,{attrs:{outlined:"",small:"",color:"success"}},[e(d.a,{attrs:{left:"",small:""}},[t._v(" mdi-check ")]),t._v("\n                    Aprovada\n                  ")],1):t._e(),t._v(" "),"rejected"===r.status?e(l.a,{attrs:{outlined:"",small:"",color:"error"}},[e(d.a,{attrs:{left:"",small:""}},[t._v(" mdi-close-thick ")]),t._v("\n                    Rejeitada\n                  ")],1):t._e(),t._v(" "),"canceled"===r.status?e(l.a,{attrs:{outlined:"",small:"",color:"error"}},[e(d.a,{attrs:{left:"",small:""}},[t._v(" mdi-cancel ")]),t._v("\n                    Cancelada\n                  ")],1):t._e(),t._v(" "),"pending"===r.status?e(l.a,{attrs:{small:"",outlined:""}},[e(d.a,{attrs:{left:"",small:""}},[t._v(" mdi-clock ")]),t._v("\n                    Aguardando aprovação\n                  ")],1):t._e()],1),t._v(" "),e("div")])])])})),1):t._e()]):e("Loading")],1)]),t._v(" "),t.addProposal?e("ProposalForm",{on:{input:t.proposalCreated,close:function(e){t.addProposal=!1}}}):t._e(),t._v(" "),t.activeProposal?e("Proposal",{attrs:{"proposal-id":t.activeProposal._id},on:{input:t.proposalUpdated,close:t.closeProposal}}):t._e()],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Alert:r(604).default,EstimateValues:r(605).default,Loading:r(602).default,ProposalForm:r(668).default,Proposal:r(669).default})}}]);